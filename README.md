# Summary
We performed unsupervised clustering on the sequences from a peptide elution assay to determine whether certain motifs tended to have similar affinities for a target peptide and whether certain motifs had greater affinities than others. The distance metric we chose for this was Levenshtein distance, a metric used for quantifying the dissimilarity of character sequences. The Levenshtein distance between two sequences increases with each edit (insertion, deletion, or substitution) needed to go from one sequence to the other. To account for the fact that amino acids can be grouped by their chemical properties and therefore certain amino acids should be considered “closer” to each other than to others, we modified the substitution penalty such that the cost to substitute an amino acid within the same group would be lower than the cost to substitute an amino acid for one in a different group. The groups were defined as follows: non-polar amino acids: glycine, alanine, valine, leucine, isoleucine, methionine, and proline; cysteine; aromatic amino acids: phenylalanine, tyrosine, and tryptophan; polar amino acids: serine, threonine, asparagine, and glutamine; acidic amino acids: glutamic acid and aspartic acid; and basic amino acids: arginine, lysine, and histidine. The within-group substitution penalty was set to 0.5, while the between-group substitution penalty was set to 1. 

To create the distance matrix, we used the Wagner-Fischer algorithm, implemented in a custom function in R that used the modified substitution penalty described above. We then performed hierarchical clustering using the “ward.D2” linkage method in the `hclust()` function in R. To select the ideal number of clusters, we used the point biserial correlation (PBC) metric, which measures the capacity of clustering to reproduce distances. PBC was stable at 0.64 for n = 20 clusters, and we therefore divided the sequences into 20 clusters. 

We then ranked the clusters by median rank score, where the rank score R of sequence i is defined as , with *m* the total number of sequences in the cluster and *r<sub>i</sub>* the rank of the *i*th sequence by sequence count (the number of peptides of a given sequence eluted off the target peptide) in descending order. Finally, we generated sequence logos for the top-ranked clusters, 4, 7, and 1 using the application at http://weblogo.berkley.edu.
